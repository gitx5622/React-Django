{"ast":null,"code":"import _classCallCheck from \"/home/gits/Desktop/React-Shopping-Cart/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/gits/Desktop/React-Shopping-Cart/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/gits/Desktop/React-Shopping-Cart/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/gits/Desktop/React-Shopping-Cart/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/gits/Desktop/React-Shopping-Cart/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/gits/Desktop/React-Shopping-Cart/src/components/Cart.js\";\nimport React from \"react\";\nimport { Container, Dimmer, Header, Icon, Image, Label, Loader, Table, Button, Message, Segment } from \"semantic-ui-react\";\nimport { connect } from \"react-redux\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { authAxios } from \"../utils\";\nimport { addToCartURL, orderSummaryURL, orderItemDeleteURL, orderItemUpdateQuantityURL } from \"../constants\";\n\nvar Cart =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Cart, _React$Component);\n\n  function Cart() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Cart);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Cart)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      data: null,\n      error: null,\n      loading: false\n    };\n\n    _this.handleFetchOrder = function () {\n      _this.setState({\n        loading: true\n      });\n\n      authAxios.get(orderSummaryURL).then(function (res) {\n        _this.setState({\n          data: res.data,\n          loading: false\n        });\n      }).catch(function (err) {\n        if (err.response.status === 404) {\n          _this.setState({\n            error: \"You currently do not have an order\",\n            loading: false\n          });\n        } else {\n          _this.setState({\n            error: err,\n            loading: false\n          });\n        }\n      });\n    };\n\n    _this.renderVariations = function (orderItem) {\n      var text = \"\";\n      orderItem.item_variations.forEach(function (iv) {\n        text += \"\".concat(iv.variation.name, \": \").concat(iv.value, \", \");\n      });\n      return text;\n    };\n\n    _this.handleFormatData = function (itemVariations) {\n      // convert [{id: 1},{id: 2}] to [1,2] - they're all variations\n      return Object.keys(itemVariations).map(function (key) {\n        return itemVariations[key].id;\n      });\n    };\n\n    _this.handleAddToCart = function (slug, itemVariations) {\n      _this.setState({\n        loading: true\n      });\n\n      var variations = _this.handleFormatData(itemVariations);\n\n      authAxios.post(addToCartURL, {\n        slug: slug,\n        variations: variations\n      }).then(function (res) {\n        _this.handleFetchOrder();\n\n        _this.setState({\n          loading: false\n        });\n      }).catch(function (err) {\n        _this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    _this.handleRemoveQuantityFromCart = function (slug) {\n      authAxios.post(orderItemUpdateQuantityURL, {\n        slug: slug\n      }).then(function (res) {\n        _this.handleFetchOrder();\n      }).catch(function (err) {\n        _this.setState({\n          error: err\n        });\n      });\n    };\n\n    _this.handleRemoveItem = function (itemID) {\n      authAxios.delete(orderItemDeleteURL(itemID)).then(function (res) {\n        _this.handleFetchOrder();\n      }).catch(function (err) {\n        _this.setState({\n          error: err\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Cart, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.handleFetchOrder();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          data = _this$state.data,\n          error = _this$state.error,\n          loading = _this$state.loading;\n      var isAuthenticated = this.props.isAuthenticated;\n\n      if (!isAuthenticated) {\n        return React.createElement(Redirect, {\n          to: \"/login\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        });\n      }\n\n      console.log(data);\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, \"Order Summary\"), error && React.createElement(Message, {\n        error: true,\n        header: \"There was an error\",\n        content: JSON.stringify(error),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }), loading && React.createElement(Segment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(Dimmer, {\n        active: true,\n        inverted: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(Loader, {\n        inverted: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, \"Loading\")), React.createElement(Image, {\n        src: \"https://react.semantic-ui.com/images/wireframe/short-paragraph.png\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      })), data && React.createElement(Table, {\n        celled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(Table.Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(Table.Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(Table.HeaderCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, \"Item #\"), React.createElement(Table.HeaderCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, \"Item name\"), React.createElement(Table.HeaderCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"Item price\"), React.createElement(Table.HeaderCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, \"Item quantity\"), React.createElement(Table.HeaderCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, \"Total item price\"))), React.createElement(Table.Body, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, data.order_items.map(function (orderItem, i) {\n        return React.createElement(Table.Row, {\n          key: orderItem.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, React.createElement(Table.Cell, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, i + 1), React.createElement(Table.Cell, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }, orderItem.item.title, \" -\", \" \", _this2.renderVariations(orderItem)), React.createElement(Table.Cell, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, \"$\", orderItem.item.price), React.createElement(Table.Cell, {\n          textAlign: \"center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          name: \"minus\",\n          style: {\n            float: \"left\",\n            cursor: \"pointer\"\n          },\n          onClick: function onClick() {\n            return _this2.handleRemoveQuantityFromCart(orderItem.item.slug);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }), orderItem.quantity, React.createElement(Icon, {\n          name: \"plus\",\n          style: {\n            float: \"right\",\n            cursor: \"pointer\"\n          },\n          onClick: function onClick() {\n            return _this2.handleAddToCart(orderItem.item.slug, orderItem.item_variations);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        })), React.createElement(Table.Cell, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, orderItem.item.discount_price && React.createElement(Label, {\n          color: \"green\",\n          ribbon: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177\n          },\n          __self: this\n        }, \"ON DISCOUNT\"), \"$\", orderItem.final_price, React.createElement(Icon, {\n          name: \"trash\",\n          color: \"red\",\n          style: {\n            float: \"right\",\n            cursor: \"pointer\"\n          },\n          onClick: function onClick() {\n            return _this2.handleRemoveItem(orderItem.id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        })));\n      }), React.createElement(Table.Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(Table.Cell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }), React.createElement(Table.Cell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }), React.createElement(Table.Cell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }), React.createElement(Table.Cell, {\n        textAlign: \"right\",\n        colSpan: \"2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, \"Order Total: $\", data.total))), React.createElement(Table.Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(Table.Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(Table.HeaderCell, {\n        colSpan: \"5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/checkout\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(Button, {\n        floated: \"right\",\n        color: \"yellow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, \"Checkout\")))))));\n    }\n  }]);\n\n  return Cart;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nexport default connect(mapStateToProps)(Cart);","map":{"version":3,"sources":["/home/gits/Desktop/React-Shopping-Cart/src/components/Cart.js"],"names":["React","Container","Dimmer","Header","Icon","Image","Label","Loader","Table","Button","Message","Segment","connect","Link","Redirect","authAxios","addToCartURL","orderSummaryURL","orderItemDeleteURL","orderItemUpdateQuantityURL","Cart","state","data","error","loading","handleFetchOrder","setState","get","then","res","catch","err","response","status","renderVariations","orderItem","text","item_variations","forEach","iv","variation","name","value","handleFormatData","itemVariations","Object","keys","map","key","id","handleAddToCart","slug","variations","post","handleRemoveQuantityFromCart","handleRemoveItem","itemID","delete","isAuthenticated","props","console","log","JSON","stringify","order_items","i","item","title","price","float","cursor","quantity","discount_price","final_price","total","Component","mapStateToProps","auth","token"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,SADF,EAEEC,MAFF,EAGEC,MAHF,EAIEC,IAJF,EAKEC,KALF,EAMEC,KANF,EAOEC,MAPF,EAQEC,KARF,EASEC,MATF,EAUEC,OAVF,EAWEC,OAXF,QAYO,mBAZP;AAaA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,IAAT,EAAeC,QAAf,QAA+B,kBAA/B;AACA,SAASC,SAAT,QAA0B,UAA1B;AACA,SACEC,YADF,EAEEC,eAFF,EAGEC,kBAHF,EAIEC,0BAJF,QAKO,cALP;;IAOMC,I;;;;;;;;;;;;;;;;;UACJC,K,GAAQ;AACNC,MAAAA,IAAI,EAAE,IADA;AAENC,MAAAA,KAAK,EAAE,IAFD;AAGNC,MAAAA,OAAO,EAAE;AAHH,K;;UAURC,gB,GAAmB,YAAM;AACvB,YAAKC,QAAL,CAAc;AAAEF,QAAAA,OAAO,EAAE;AAAX,OAAd;;AACAT,MAAAA,SAAS,CACNY,GADH,CACOV,eADP,EAEGW,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACX,cAAKH,QAAL,CAAc;AAAEJ,UAAAA,IAAI,EAAEO,GAAG,CAACP,IAAZ;AAAkBE,UAAAA,OAAO,EAAE;AAA3B,SAAd;AACD,OAJH,EAKGM,KALH,CAKS,UAAAC,GAAG,EAAI;AACZ,YAAIA,GAAG,CAACC,QAAJ,CAAaC,MAAb,KAAwB,GAA5B,EAAiC;AAC/B,gBAAKP,QAAL,CAAc;AACZH,YAAAA,KAAK,EAAE,oCADK;AAEZC,YAAAA,OAAO,EAAE;AAFG,WAAd;AAID,SALD,MAKO;AACL,gBAAKE,QAAL,CAAc;AAAEH,YAAAA,KAAK,EAAEQ,GAAT;AAAcP,YAAAA,OAAO,EAAE;AAAvB,WAAd;AACD;AACF,OAdH;AAeD,K;;UAEDU,gB,GAAmB,UAAAC,SAAS,EAAI;AAC9B,UAAIC,IAAI,GAAG,EAAX;AACAD,MAAAA,SAAS,CAACE,eAAV,CAA0BC,OAA1B,CAAkC,UAAAC,EAAE,EAAI;AACtCH,QAAAA,IAAI,cAAOG,EAAE,CAACC,SAAH,CAAaC,IAApB,eAA6BF,EAAE,CAACG,KAAhC,OAAJ;AACD,OAFD;AAGA,aAAON,IAAP;AACD,K;;UAEDO,gB,GAAmB,UAAAC,cAAc,EAAI;AACnC;AACA,aAAOC,MAAM,CAACC,IAAP,CAAYF,cAAZ,EAA4BG,GAA5B,CAAgC,UAAAC,GAAG,EAAI;AAC5C,eAAOJ,cAAc,CAACI,GAAD,CAAd,CAAoBC,EAA3B;AACD,OAFM,CAAP;AAGD,K;;UAEDC,e,GAAkB,UAACC,IAAD,EAAOP,cAAP,EAA0B;AAC1C,YAAKlB,QAAL,CAAc;AAAEF,QAAAA,OAAO,EAAE;AAAX,OAAd;;AACA,UAAM4B,UAAU,GAAG,MAAKT,gBAAL,CAAsBC,cAAtB,CAAnB;;AACA7B,MAAAA,SAAS,CACNsC,IADH,CACQrC,YADR,EACsB;AAAEmC,QAAAA,IAAI,EAAJA,IAAF;AAAQC,QAAAA,UAAU,EAAVA;AAAR,OADtB,EAEGxB,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACX,cAAKJ,gBAAL;;AACA,cAAKC,QAAL,CAAc;AAAEF,UAAAA,OAAO,EAAE;AAAX,SAAd;AACD,OALH,EAMGM,KANH,CAMS,UAAAC,GAAG,EAAI;AACZ,cAAKL,QAAL,CAAc;AAAEH,UAAAA,KAAK,EAAEQ,GAAT;AAAcP,UAAAA,OAAO,EAAE;AAAvB,SAAd;AACD,OARH;AASD,K;;UAED8B,4B,GAA+B,UAAAH,IAAI,EAAI;AACrCpC,MAAAA,SAAS,CACNsC,IADH,CACQlC,0BADR,EACoC;AAAEgC,QAAAA,IAAI,EAAJA;AAAF,OADpC,EAEGvB,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACX,cAAKJ,gBAAL;AACD,OAJH,EAKGK,KALH,CAKS,UAAAC,GAAG,EAAI;AACZ,cAAKL,QAAL,CAAc;AAAEH,UAAAA,KAAK,EAAEQ;AAAT,SAAd;AACD,OAPH;AAQD,K;;UAEDwB,gB,GAAmB,UAAAC,MAAM,EAAI;AAC3BzC,MAAAA,SAAS,CACN0C,MADH,CACUvC,kBAAkB,CAACsC,MAAD,CAD5B,EAEG5B,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACX,cAAKJ,gBAAL;AACD,OAJH,EAKGK,KALH,CAKS,UAAAC,GAAG,EAAI;AACZ,cAAKL,QAAL,CAAc;AAAEH,UAAAA,KAAK,EAAEQ;AAAT,SAAd;AACD,OAPH;AAQD,K;;;;;;;wCAxEmB;AAClB,WAAKN,gBAAL;AACD;;;6BAwEQ;AAAA;;AAAA,wBAC0B,KAAKJ,KAD/B;AAAA,UACCC,IADD,eACCA,IADD;AAAA,UACOC,KADP,eACOA,KADP;AAAA,UACcC,OADd,eACcA,OADd;AAAA,UAECkC,eAFD,GAEqB,KAAKC,KAF1B,CAECD,eAFD;;AAGP,UAAI,CAACA,eAAL,EAAsB;AACpB,eAAO,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACD;;AACDE,MAAAA,OAAO,CAACC,GAAR,CAAYvC,IAAZ;AAEA,aACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADF,EAEGC,KAAK,IACJ,oBAAC,OAAD;AACE,QAAA,KAAK,MADP;AAEE,QAAA,MAAM,EAAC,oBAFT;AAGE,QAAA,OAAO,EAAEuC,IAAI,CAACC,SAAL,CAAexC,KAAf,CAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHJ,EASGC,OAAO,IACN,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,MAAM,MAAd;AAAe,QAAA,QAAQ,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,CADF,EAKE,oBAAC,KAAD;AAAO,QAAA,GAAG,EAAC,oEAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALF,CAVJ,EAkBGF,IAAI,IACH,oBAAC,KAAD;AAAO,QAAA,MAAM,MAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD,CAAO,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD,CAAO,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAEE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAFF,EAGE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAHF,EAIE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAJF,EAKE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BALF,CADF,CADF,EAWE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGA,IAAI,CAAC0C,WAAL,CAAiBjB,GAAjB,CAAqB,UAACZ,SAAD,EAAY8B,CAAZ,EAAkB;AACtC,eACE,oBAAC,KAAD,CAAO,GAAP;AAAW,UAAA,GAAG,EAAE9B,SAAS,CAACc,EAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAagB,CAAC,GAAG,CAAjB,CADF,EAEE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACG9B,SAAS,CAAC+B,IAAV,CAAeC,KADlB,QAC2B,GAD3B,EAEG,MAAI,CAACjC,gBAAL,CAAsBC,SAAtB,CAFH,CAFF,EAME,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAcA,SAAS,CAAC+B,IAAV,CAAeE,KAA7B,CANF,EAOE,oBAAC,KAAD,CAAO,IAAP;AAAY,UAAA,SAAS,EAAC,QAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,IAAD;AACE,UAAA,IAAI,EAAC,OADP;AAEE,UAAA,KAAK,EAAE;AAAEC,YAAAA,KAAK,EAAE,MAAT;AAAiBC,YAAAA,MAAM,EAAE;AAAzB,WAFT;AAGE,UAAA,OAAO,EAAE;AAAA,mBACP,MAAI,CAAChB,4BAAL,CAAkCnB,SAAS,CAAC+B,IAAV,CAAef,IAAjD,CADO;AAAA,WAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,EAQGhB,SAAS,CAACoC,QARb,EASE,oBAAC,IAAD;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,KAAK,EAAE;AAAEF,YAAAA,KAAK,EAAE,OAAT;AAAkBC,YAAAA,MAAM,EAAE;AAA1B,WAFT;AAGE,UAAA,OAAO,EAAE;AAAA,mBACP,MAAI,CAACpB,eAAL,CACEf,SAAS,CAAC+B,IAAV,CAAef,IADjB,EAEEhB,SAAS,CAACE,eAFZ,CADO;AAAA,WAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UATF,CAPF,EA2BE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACGF,SAAS,CAAC+B,IAAV,CAAeM,cAAf,IACC,oBAAC,KAAD;AAAO,UAAA,KAAK,EAAC,OAAb;AAAqB,UAAA,MAAM,MAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAFJ,OAMIrC,SAAS,CAACsC,WANd,EAOE,oBAAC,IAAD;AACE,UAAA,IAAI,EAAC,OADP;AAEE,UAAA,KAAK,EAAC,KAFR;AAGE,UAAA,KAAK,EAAE;AAAEJ,YAAAA,KAAK,EAAE,OAAT;AAAkBC,YAAAA,MAAM,EAAE;AAA1B,WAHT;AAIE,UAAA,OAAO,EAAE;AAAA,mBAAM,MAAI,CAACf,gBAAL,CAAsBpB,SAAS,CAACc,EAAhC,CAAN;AAAA,WAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAPF,CA3BF,CADF;AA4CD,OA7CA,CADH,EA+CE,oBAAC,KAAD,CAAO,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,EAGE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAIE,oBAAC,KAAD,CAAO,IAAP;AAAY,QAAA,SAAS,EAAC,OAAtB;AAA8B,QAAA,OAAO,EAAC,GAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BACiB3B,IAAI,CAACoD,KADtB,CAJF,CA/CF,CAXF,EAoEE,oBAAC,KAAD,CAAO,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD,CAAO,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD,CAAO,UAAP;AAAkB,QAAA,OAAO,EAAC,GAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,WAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,OAAO,EAAC,OAAhB;AAAwB,QAAA,KAAK,EAAC,QAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,CADF,CADF,CADF,CApEF,CAnBJ,CADF;AAuGD;;;;EAhMgB1E,KAAK,CAAC2E,S;;AAmMzB,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAvD,KAAK,EAAI;AAC/B,SAAO;AACLqC,IAAAA,eAAe,EAAErC,KAAK,CAACwD,IAAN,CAAWC,KAAX,KAAqB;AADjC,GAAP;AAGD,CAJD;;AAMA,eAAelE,OAAO,CAACgE,eAAD,CAAP,CAAyBxD,IAAzB,CAAf","sourcesContent":["import React from \"react\";\r\nimport {\r\n  Container,\r\n  Dimmer,\r\n  Header,\r\n  Icon,\r\n  Image,\r\n  Label,\r\n  Loader,\r\n  Table,\r\n  Button,\r\n  Message,\r\n  Segment\r\n} from \"semantic-ui-react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport { authAxios } from \"../utils\";\r\nimport {\r\n  addToCartURL,\r\n  orderSummaryURL,\r\n  orderItemDeleteURL,\r\n  orderItemUpdateQuantityURL\r\n} from \"../constants\";\r\n\r\nclass Cart extends React.Component {\r\n  state = {\r\n    data: null,\r\n    error: null,\r\n    loading: false\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.handleFetchOrder();\r\n  }\r\n\r\n  handleFetchOrder = () => {\r\n    this.setState({ loading: true });\r\n    authAxios\r\n      .get(orderSummaryURL)\r\n      .then(res => {\r\n        this.setState({ data: res.data, loading: false });\r\n      })\r\n      .catch(err => {\r\n        if (err.response.status === 404) {\r\n          this.setState({\r\n            error: \"You currently do not have an order\",\r\n            loading: false\r\n          });\r\n        } else {\r\n          this.setState({ error: err, loading: false });\r\n        }\r\n      });\r\n  };\r\n\r\n  renderVariations = orderItem => {\r\n    let text = \"\";\r\n    orderItem.item_variations.forEach(iv => {\r\n      text += `${iv.variation.name}: ${iv.value}, `;\r\n    });\r\n    return text;\r\n  };\r\n\r\n  handleFormatData = itemVariations => {\r\n    // convert [{id: 1},{id: 2}] to [1,2] - they're all variations\r\n    return Object.keys(itemVariations).map(key => {\r\n      return itemVariations[key].id;\r\n    });\r\n  };\r\n\r\n  handleAddToCart = (slug, itemVariations) => {\r\n    this.setState({ loading: true });\r\n    const variations = this.handleFormatData(itemVariations);\r\n    authAxios\r\n      .post(addToCartURL, { slug, variations })\r\n      .then(res => {\r\n        this.handleFetchOrder();\r\n        this.setState({ loading: false });\r\n      })\r\n      .catch(err => {\r\n        this.setState({ error: err, loading: false });\r\n      });\r\n  };\r\n\r\n  handleRemoveQuantityFromCart = slug => {\r\n    authAxios\r\n      .post(orderItemUpdateQuantityURL, { slug })\r\n      .then(res => {\r\n        this.handleFetchOrder();\r\n      })\r\n      .catch(err => {\r\n        this.setState({ error: err });\r\n      });\r\n  };\r\n\r\n  handleRemoveItem = itemID => {\r\n    authAxios\r\n      .delete(orderItemDeleteURL(itemID))\r\n      .then(res => {\r\n        this.handleFetchOrder();\r\n      })\r\n      .catch(err => {\r\n        this.setState({ error: err });\r\n      });\r\n  };\r\n\r\n  render() {\r\n    const { data, error, loading } = this.state;\r\n    const { isAuthenticated } = this.props;\r\n    if (!isAuthenticated) {\r\n      return <Redirect to=\"/login\" />;\r\n    }\r\n    console.log(data);\r\n\r\n    return (\r\n      <Container>\r\n        <Header>Order Summary</Header>\r\n        {error && (\r\n          <Message\r\n            error\r\n            header=\"There was an error\"\r\n            content={JSON.stringify(error)}\r\n          />\r\n        )}\r\n        {loading && (\r\n          <Segment>\r\n            <Dimmer active inverted>\r\n              <Loader inverted>Loading</Loader>\r\n            </Dimmer>\r\n\r\n            <Image src=\"https://react.semantic-ui.com/images/wireframe/short-paragraph.png\" />\r\n          </Segment>\r\n        )}\r\n        {data && (\r\n          <Table celled>\r\n            <Table.Header>\r\n              <Table.Row>\r\n                <Table.HeaderCell>Item #</Table.HeaderCell>\r\n                <Table.HeaderCell>Item name</Table.HeaderCell>\r\n                <Table.HeaderCell>Item price</Table.HeaderCell>\r\n                <Table.HeaderCell>Item quantity</Table.HeaderCell>\r\n                <Table.HeaderCell>Total item price</Table.HeaderCell>\r\n              </Table.Row>\r\n            </Table.Header>\r\n\r\n            <Table.Body>\r\n              {data.order_items.map((orderItem, i) => {\r\n                return (\r\n                  <Table.Row key={orderItem.id}>\r\n                    <Table.Cell>{i + 1}</Table.Cell>\r\n                    <Table.Cell>\r\n                      {orderItem.item.title} -{\" \"}\r\n                      {this.renderVariations(orderItem)}\r\n                    </Table.Cell>\r\n                    <Table.Cell>${orderItem.item.price}</Table.Cell>\r\n                    <Table.Cell textAlign=\"center\">\r\n                      <Icon\r\n                        name=\"minus\"\r\n                        style={{ float: \"left\", cursor: \"pointer\" }}\r\n                        onClick={() =>\r\n                          this.handleRemoveQuantityFromCart(orderItem.item.slug)\r\n                        }\r\n                      />\r\n                      {orderItem.quantity}\r\n                      <Icon\r\n                        name=\"plus\"\r\n                        style={{ float: \"right\", cursor: \"pointer\" }}\r\n                        onClick={() =>\r\n                          this.handleAddToCart(\r\n                            orderItem.item.slug,\r\n                            orderItem.item_variations\r\n                          )\r\n                        }\r\n                      />\r\n                    </Table.Cell>\r\n                    <Table.Cell>\r\n                      {orderItem.item.discount_price && (\r\n                        <Label color=\"green\" ribbon>\r\n                          ON DISCOUNT\r\n                        </Label>\r\n                      )}\r\n                      ${orderItem.final_price}\r\n                      <Icon\r\n                        name=\"trash\"\r\n                        color=\"red\"\r\n                        style={{ float: \"right\", cursor: \"pointer\" }}\r\n                        onClick={() => this.handleRemoveItem(orderItem.id)}\r\n                      />\r\n                    </Table.Cell>\r\n                  </Table.Row>\r\n                );\r\n              })}\r\n              <Table.Row>\r\n                <Table.Cell />\r\n                <Table.Cell />\r\n                <Table.Cell />\r\n                <Table.Cell textAlign=\"right\" colSpan=\"2\">\r\n                  Order Total: ${data.total}\r\n                </Table.Cell>\r\n              </Table.Row>\r\n            </Table.Body>\r\n\r\n            <Table.Footer>\r\n              <Table.Row>\r\n                <Table.HeaderCell colSpan=\"5\">\r\n                  <Link to=\"/checkout\">\r\n                    <Button floated=\"right\" color=\"yellow\">\r\n                      Checkout\r\n                    </Button>\r\n                  </Link>\r\n                </Table.HeaderCell>\r\n              </Table.Row>\r\n            </Table.Footer>\r\n          </Table>\r\n        )}\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    isAuthenticated: state.auth.token !== null\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(Cart);\r\n"]},"metadata":{},"sourceType":"module"}